<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html>

<head>
	<title></title>
	<style type="text/css">

	body, p, td, th, li {
		font-family: verdana, sans-serif;
		font-size: 10pt;
	}

	big.top {
		font-size: 18pt;
		font-weight: bold;
	}

	big {
		font-size: 13pt;
		font-weight: bold;
	}
	
	a {
		font-weight:bold;
		color: #cc3333;
		text-decoration:none;
	}
	a:hover	{
		text-decoration:underline;
	}

	.navig	{
		font-size: 9px;
		text-decoration: none;
		font-weight:normal;
	}
	
	li {
		padding-bottom: 5px;
	}
	

	.mainbox	{
		border-color:#999999;
		padding-top:5px;
		padding-bottom:5px;
		border-bottom-width:1px;
		border-bottom-style:dotted;
	}	

	.headline {
		font-weight:bold;
		background:#dfdfdf;
		border-color:#999999;
		padding-top:5px;
		padding-bottom:5px;
	}	

	</style>
</head>

<body>

<table width="90%" border="0" cellspacing="1" cellpadding="5">
<tr>
	<td class="headline">
	<big><tt>Global.helma.Inspector&nbsp;(hopObj)</tt></big><br>
	</td>
</tr>

<tr>
	<td class="mainbox">
	
	
	<ul>
		
		
		
		
		
		
	</ul>
	</td>
</tr>
</table>

<table width="90%" border="0" cellspacing="1" cellpadding="5">
<tr>
	<td>Sourcecode in helmaTools.zip/Global/helma.Inspector.js:
	<pre><font color="#aaaaaa">26:</font>   helma.Inspector = function(hopObj) {
<font color="#aaaaaa">27:</font>       if (!hopObj)
<font color="#aaaaaa">28:</font>           hopObj == root;
<font color="#aaaaaa">29:</font>   
<font color="#aaaaaa">30:</font>       var version = <font color="#9999aa">&quot;4.0&quot;</font>;
<font color="#aaaaaa">31:</font>       var children = [];
<font color="#aaaaaa">32:</font>       var properties = [];
<font color="#aaaaaa">33:</font>       var collections = [];
<font color="#aaaaaa">34:</font>   
<font color="#aaaaaa">35:</font>      var html = new helma.Html();
<font color="#aaaaaa">36:</font>      var keySorter = new String.Sorter(<font color="#9999aa">&quot;key&quot;</font>);
<font color="#aaaaaa">37:</font>      var idSorter = new Number.Sorter(<font color="#9999aa">&quot;id&quot;</font>);
<font color="#aaaaaa">38:</font>  
<font color="#aaaaaa">39:</font>      var skins = {
<font color="#aaaaaa">40:</font>          child: createSkin(helma.Inspector.child_skin),
<font color="#aaaaaa">41:</font>          collection: createSkin(helma.Inspector.collection_skin),
<font color="#aaaaaa">42:</font>          date: createSkin(helma.Inspector.date_skin),
<font color="#aaaaaa">43:</font>          editor: createSkin(helma.Inspector.editor_skin),
<font color="#aaaaaa">44:</font>          property: createSkin(helma.Inspector.property_skin)
<font color="#aaaaaa">45:</font>      };
<font color="#aaaaaa">46:</font>  
<font color="#aaaaaa">47:</font>      var genOptions = function(start, end, selected) {
<font color="#aaaaaa">48:</font>          res.push();
<font color="#aaaaaa">49:</font>          for (var i=start; i&lt;=end; i+=1) {
<font color="#aaaaaa">50:</font>              res.write(<font color="#9999aa">&quot;&lt;option&quot;</font>);
<font color="#aaaaaa">51:</font>              if (i == selected)
<font color="#aaaaaa">52:</font>                  res.write(' selected=<font color="#9999aa">&quot;selected&quot;</font>');
<font color="#aaaaaa">53:</font>              res.write(<font color="#9999aa">&quot;&gt;&quot;</font>);
<font color="#aaaaaa">54:</font>              if (i &lt; 10)
<font color="#aaaaaa">55:</font>                  res.write(<font color="#9999aa">&quot;0&quot;</font>);
<font color="#aaaaaa">56:</font>              res.write(i);
<font color="#aaaaaa">57:</font>              res.write(<font color="#9999aa">&quot;&lt;/option&gt;\n&quot;</font>);
<font color="#aaaaaa">58:</font>          }
<font color="#aaaaaa">59:</font>          return res.pop();
<font color="#aaaaaa">60:</font>      };
<font color="#aaaaaa">61:</font>  
<font color="#aaaaaa">62:</font>      this.render = function() {
<font color="#aaaaaa">63:</font>          for (var i in hopObj) {
<font color="#aaaaaa">64:</font>              var obj = {
<font color="#aaaaaa">65:</font>                  key: i,
<font color="#aaaaaa">66:</font>                  value: hopObj[i]
<font color="#aaaaaa">67:</font>              };
<font color="#aaaaaa">68:</font>              if (hopObj[i]) {
<font color="#aaaaaa">69:</font>                  if (obj.value._prototype &amp;&amp;
<font color="#aaaaaa">70:</font>                       obj.value._prototype == <font color="#9999aa">&quot;HopObject&quot;</font>)
<font color="#aaaaaa">71:</font>                      collections.push(obj);
<font color="#aaaaaa">72:</font>                  else
<font color="#aaaaaa">73:</font>                      properties.push(obj);
<font color="#aaaaaa">74:</font>              }
<font color="#aaaaaa">75:</font>          }
<font color="#aaaaaa">76:</font>          properties.sort(keySorter);
<font color="#aaaaaa">77:</font>          collections.sort(keySorter);
<font color="#aaaaaa">78:</font>  
<font color="#aaaaaa">79:</font>          var n = hopObj.size();
<font color="#aaaaaa">80:</font>          for (var i=0; i&lt;n; i++) {
<font color="#aaaaaa">81:</font>              var h = hopObj.get(i);
<font color="#aaaaaa">82:</font>              var obj = {
<font color="#aaaaaa">83:</font>                  key: i,
<font color="#aaaaaa">84:</font>                  value: h,
<font color="#aaaaaa">85:</font>                  id: h._id
<font color="#aaaaaa">86:</font>              };
<font color="#aaaaaa">87:</font>              children.push(obj);
<font color="#aaaaaa">88:</font>          }
<font color="#aaaaaa">89:</font>          children.sort(idSorter);
<font color="#aaaaaa">90:</font>  
<font color="#aaaaaa">91:</font>          res.handlers.inspector = this;
<font color="#aaaaaa">92:</font>          renderSkin(<font color="#9999aa">&quot;helma.Inspector.main&quot;</font>);
<font color="#aaaaaa">93:</font>          return;
<font color="#aaaaaa">94:</font>      };
<font color="#aaaaaa">95:</font>  
<font color="#aaaaaa">96:</font>      this.action = function() {
<font color="#aaaaaa">97:</font>          if (req.data.done) {
<font color="#aaaaaa">98:</font>              helma.invalidate('inspector');
<font color="#aaaaaa">99:</font>              res.redirect(path.href());
<font color="#aaaaaa">100:</font>          }
<font color="#aaaaaa">101:</font>          if (!helma.auth('inspector'))
<font color="#aaaaaa">102:</font>              res.abort();
<font color="#aaaaaa">103:</font>          if (req.data.cancel)
<font color="#aaaaaa">104:</font>              res.redirect(req.action);
<font color="#aaaaaa">105:</font>          else if (req.data.save) {
<font color="#aaaaaa">106:</font>              if (req.data.type == <font color="#9999aa">&quot;date&quot;</font>) {
<font color="#aaaaaa">107:</font>                  hopObj[req.data.key] = new Date(
<font color="#aaaaaa">108:</font>                      req.data.y, req.data.M-1, req.data.d,
<font color="#aaaaaa">109:</font>                      req.data.H, req.data.m, req.data.s
<font color="#aaaaaa">110:</font>                  );
<font color="#aaaaaa">111:</font>              } else
<font color="#aaaaaa">112:</font>                  hopObj[req.data.key] = req.data[req.data.key];
<font color="#aaaaaa">113:</font>              res.redirect(req.action);
<font color="#aaaaaa">114:</font>          };
<font color="#aaaaaa">115:</font>          this.render();
<font color="#aaaaaa">116:</font>      };
<font color="#aaaaaa">117:</font>  
<font color="#aaaaaa">118:</font>  
<font color="#aaaaaa">119:</font>      /*****    M A C R O S    *****/
<font color="#aaaaaa">120:</font>  
<font color="#aaaaaa">121:</font>      this.version_macro = function() {
<font color="#aaaaaa">122:</font>          return version;
<font color="#aaaaaa">123:</font>      };
<font color="#aaaaaa">124:</font>  
<font color="#aaaaaa">125:</font>     this.title_macro = function() {
<font color="#aaaaaa">126:</font>         var str = String(hopObj);
<font color="#aaaaaa">127:</font>         res.write(hopObj);
<font color="#aaaaaa">128:</font>         return;
<font color="#aaaaaa">129:</font>     };
<font color="#aaaaaa">130:</font> 
<font color="#aaaaaa">131:</font>     this.prototype_macro = function() {
<font color="#aaaaaa">132:</font>         if (hopObj != root)
<font color="#aaaaaa">133:</font>             res.write(hopObj._prototype);
<font color="#aaaaaa">134:</font>         return;
<font color="#aaaaaa">135:</font>     };
<font color="#aaaaaa">136:</font> 
<font color="#aaaaaa">137:</font>     this.this_macro = function() {
<font color="#aaaaaa">138:</font>         res.write(hopObj);
<font color="#aaaaaa">139:</font>         return;
<font color="#aaaaaa">140:</font>     };
<font color="#aaaaaa">141:</font> 
<font color="#aaaaaa">142:</font>     this.parent_macro = function() {
<font color="#aaaaaa">143:</font>         res.write(hopObj._parent);
<font color="#aaaaaa">144:</font>         return;
<font color="#aaaaaa">145:</font>     };
<font color="#aaaaaa">146:</font> 
<font color="#aaaaaa">147:</font>     this.href_macro = function() {
<font color="#aaaaaa">148:</font>         res.write(hopObj.href(req.action));
<font color="#aaaaaa">149:</font>         return;
<font color="#aaaaaa">150:</font>     };
<font color="#aaaaaa">151:</font> 
<font color="#aaaaaa">152:</font>     this.path_macro = function() {
<font color="#aaaaaa">153:</font>         for (var i=0; i&lt;path.length-1; i++) {
<font color="#aaaaaa">154:</font>             var obj = path[i];
<font color="#aaaaaa">155:</font>             html.link({href: obj.href(req.action)},
<font color="#aaaaaa">156:</font>                 (obj == root ? obj._prototype : obj));
<font color="#aaaaaa">157:</font>             res.write(<font color="#9999aa">&quot; / &quot;</font>);
<font color="#aaaaaa">158:</font>         }
<font color="#aaaaaa">159:</font>         return;
<font color="#aaaaaa">160:</font>     };
<font color="#aaaaaa">161:</font> 
<font color="#aaaaaa">162:</font>     this.collections_macro = function() {
<font color="#aaaaaa">163:</font>         for (var i in collections) {
<font color="#aaaaaa">164:</font>             var obj = collections[i];
<font color="#aaaaaa">165:</font>             var param = {
<font color="#aaaaaa">166:</font>                 href: obj.value.href(req.action),
<font color="#aaaaaa">167:</font>                 key: obj.key,
<font color="#aaaaaa">168:</font>                 size: obj.value.size()
<font color="#aaaaaa">169:</font>             };
<font color="#aaaaaa">170:</font>             renderSkin(skins.collection, param);
<font color="#aaaaaa">171:</font>         }
<font color="#aaaaaa">172:</font>         return;
<font color="#aaaaaa">173:</font>     };
<font color="#aaaaaa">174:</font> 
<font color="#aaaaaa">175:</font>     this.childProto_macro = function() {
<font color="#aaaaaa">176:</font>         var first = hopObj.get(0);
<font color="#aaaaaa">177:</font>         if (first)
<font color="#aaaaaa">178:</font>             res.write(first._prototype);
<font color="#aaaaaa">179:</font>         return;
<font color="#aaaaaa">180:</font>     };
<font color="#aaaaaa">181:</font> 
<font color="#aaaaaa">182:</font>     this.properties_macro = function() {
<font color="#aaaaaa">183:</font>         if (hopObj._id) {
<font color="#aaaaaa">184:</font>             renderSkin(skins.property, {
<font color="#aaaaaa">185:</font>                 title: <font color="#9999aa">&quot;_id&quot;</font>, value: hopObj._id
<font color="#aaaaaa">186:</font>             });
<font color="#aaaaaa">187:</font>             renderSkin(skins.property, {
<font color="#aaaaaa">188:</font>                 title: <font color="#9999aa">&quot;_prototype&quot;</font>, value: hopObj._prototype
<font color="#aaaaaa">189:</font>             });
<font color="#aaaaaa">190:</font>         }
<font color="#aaaaaa">191:</font> 
<font color="#aaaaaa">192:</font>         if (hopObj._parent) {
<font color="#aaaaaa">193:</font>             renderSkin(skins.property, {
<font color="#aaaaaa">194:</font>                 title: html.linkAsString({
<font color="#aaaaaa">195:</font>                     href: hopObj._parent.href(req.action)
<font color="#aaaaaa">196:</font>                 }, <font color="#9999aa">&quot;_parent&quot;</font>),
<font color="#aaaaaa">197:</font>                 value: hopObj._parent
<font color="#aaaaaa">198:</font>             });
<font color="#aaaaaa">199:</font>         }
<font color="#aaaaaa">200:</font> 
<font color="#aaaaaa">201:</font>         for (var i in properties) {
<font color="#aaaaaa">202:</font>             var obj = properties[i];
<font color="#aaaaaa">203:</font>             if (obj.value instanceof Date) {
<font color="#aaaaaa">204:</font>                 var param = {value: obj.value.toString()};
<font color="#aaaaaa">205:</font>                 param.title = html.linkAsString({
<font color="#aaaaaa">206:</font>                     href: <font color="#9999aa">&quot;javascript:void(null)&quot;</font>,
<font color="#aaaaaa">207:</font>                     onclick: <font color="#9999aa">&quot;toggleEditor(this)&quot;</font>
<font color="#aaaaaa">208:</font>                 }, obj.key);
<font color="#aaaaaa">209:</font>                 param.key = obj.key;
<font color="#aaaaaa">210:</font>                 param.years = genOptions(1970, 2070, obj.value.getFullYear());
<font color="#aaaaaa">211:</font>                 param.months = genOptions(1, 12, obj.value.getMonth()+1);
<font color="#aaaaaa">212:</font>                 param.days = genOptions(1, 31, obj.value.getDate());
<font color="#aaaaaa">213:</font>                 param.hours = genOptions(0, 23, obj.value.getHours());
<font color="#aaaaaa">214:</font>                 param.minutes = genOptions(0, 59, obj.value.getMinutes());
<font color="#aaaaaa">215:</font>                 param.seconds = genOptions(0, 59, obj.value.getSeconds());
<font color="#aaaaaa">216:</font>                 renderSkin(skins.date, param);
<font color="#aaaaaa">217:</font>             } else {
<font color="#aaaaaa">218:</font>                 var param = {value: obj.value};
<font color="#aaaaaa">219:</font>                 if (obj.value.href) {
<font color="#aaaaaa">220:</font>                     param.title = html.linkAsString({href: obj.value.href(req.action)}, obj.key);
<font color="#aaaaaa">221:</font>                     renderSkin(skins.property, param);
<font color="#aaaaaa">222:</font>                 } else {
<font color="#aaaaaa">223:</font>                     param.title = html.linkAsString({
<font color="#aaaaaa">224:</font>                         href: <font color="#9999aa">&quot;javascript:void(null)&quot;</font>,
<font color="#aaaaaa">225:</font>                         onclick: <font color="#9999aa">&quot;toggleEditor(this)&quot;</font>
<font color="#aaaaaa">226:</font>                     }, obj.key);
<font color="#aaaaaa">227:</font>                     param.key = obj.key;
<font color="#aaaaaa">228:</font>                     renderSkin(skins.editor, param);
<font color="#aaaaaa">229:</font>                 }
<font color="#aaaaaa">230:</font>             }
<font color="#aaaaaa">231:</font>         }
<font color="#aaaaaa">232:</font> 
<font color="#aaaaaa">233:</font>         return;
<font color="#aaaaaa">234:</font>     };
<font color="#aaaaaa">235:</font> 
<font color="#aaaaaa">236:</font>     this.children_macro = function() {
<font color="#aaaaaa">237:</font>         for (var i in children) {
<font color="#aaaaaa">238:</font>             var obj = children[i];
<font color="#aaaaaa">239:</font>             renderSkin(skins.child, {
<font color="#aaaaaa">240:</font>                 href: obj.value.href(req.action),
<font color="#aaaaaa">241:</font> <font color="#33aa00">                //prototype: obj.value._prototype,
<font color="#aaaaaa">242:</font> </font>                title: obj.value
<font color="#aaaaaa">243:</font>             });
<font color="#aaaaaa">244:</font>         }
<font color="#aaaaaa">245:</font>         return;
<font color="#aaaaaa">246:</font>     };
<font color="#aaaaaa">247:</font> 
<font color="#aaaaaa">248:</font>     for (var i in this)
<font color="#aaaaaa">249:</font>         this.dontEnum(i);
<font color="#aaaaaa">250:</font> 
<font color="#aaaaaa">251:</font>     return this;
<font color="#aaaaaa">252:</font> }
</pre>
	</td>
</tr>

</table>





</body>
</html>
